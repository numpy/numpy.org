<!DOCTYPE html>
<html lang="en-us">

<head>
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-162151853-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<meta name="description" content="Why NumPy? Powerful n-dimensional arrays. Numerical computing tools. Interoperable. Performant. Open source." />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NumPy</title>
  
<link href="https://fonts.googleapis.com/css?family=Lato:400,900" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/css/style.min.cf5efcb8a6e49b945af419cd8b208a5ae87eb3015995b9afc61218743a0fed3e.css" integrity="sha256-z178uKbkm5Ra9BnNiyCKWuh&#43;swFZlbmvxhIYdDoP7T4=">
<link rel="stylesheet" type="text/css" href="/css/icons.css">

<link rel="icon" type="image/png" href="/images/favicon.png" />

<link href="https://fonts.googleapis.com/css?family=Lato:400,900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap" rel="stylesheet">

<link rel="stylesheet" type="text/css" href="/css/styles.css" />
<link rel="stylesheet" type="text/css" href="/css/shell.css" />
<link rel="stylesheet" type="text/css" href="/css/tabs.css" />
<link rel="stylesheet" type="text/css" href="/css/content.css" />
<link rel="stylesheet" type="text/css" href="/css/news.css" />
<link rel="stylesheet" type="text/css" href="/css/keyfeatures.css" />
<link rel="stylesheet" type="text/css" href="/css/casestudies.css" />

</head>

<body>
  

  


<nav id="nav" class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      
            <a id="navbar-item" class="navbar-item" href="/">
                <img src="/images/logos/numpy.svg" alt="Numpy logo. A three-dimensional blue cube with the letter 'N' highlighted in yellow." width="112" height="28" alt="Numpy logo. A three-dimensional blue cube with the letter 'N' highlighted in yellow.">
            </a>
      

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

      <div id="navbar-menu" class="navbar-menu is-static">

        <div class="navbar-end">
          <a href="/install" id="navbar-item" class="navbar-item is-secondary">
            Install
          </a>
          <a href="https://numpy.org/doc/stable" id="navbar-item" class="navbar-item is-secondary">
            Documentation
          </a>
          <a href="/learn" id="navbar-item" class="navbar-item is-secondary">
            Learn
          </a>
          <a href="/community" id="navbar-item" class="navbar-item is-secondary">
            Community
          </a>
          <a href="/about" id="navbar-item" class="navbar-item is-secondary">
            About Us
          </a>
          <a href="/contribute" id="navbar-item" class="navbar-item is-secondary">
            Contribute
          </a>

          
        </div>
      </div>
  </div>
</nav>




<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a id="navbar-item" class="navbar-item" href="/">
        <img src="/images/logos/numpy.svg" alt="" width="112" height="28">
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="cloned-navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="cloned-navbar-menu" class="navbar-menu is-fixed">

      <div class="navbar-end">
        <a href="/install" id="navbar-item" class="navbar-item is-secondary">
          Install
        </a>
        <a href="https://numpy.org/doc/stable" id="navbar-item" class="navbar-item is-secondary">
          Documentation
        </a>
        <a href="/learn" id="navbar-item" class="navbar-item is-secondary">
          Learn
        </a>
        <a href="/community" id="navbar-item" class="navbar-item is-secondary">
          Community
        </a>
        <a href="/about" id="navbar-item" class="navbar-item is-secondary">
          About Us
        </a>
        <a href="/contribute" id="navbar-item" class="navbar-item is-secondary">
          Contribute
        </a>
        
      </div>
    </div>
</div>
</nav>

<section class="content-padding flex-row">
    <div class="shortcuts-container">
        <div class="shortcuts-title">Shortcuts</div>
        <div id="shortcuts"></div>
        <div class="sidebar-links">
            <a href="/gethelp">Get Help</a>
        </div>
    </div>
    <div class="content-container">
        <div class="columns">
            <div class="column is-centered-tablet-portrait">
                <h1 class="title section-title">Case Study: DeepLabCut 3D Pose Estimation</h1>
                <h5 class="subtitle is-5 is-muted"></h5>
                <div class="divider"></div>
            </div>
        </div>
        <figure class="fig-center">
    <img src="/images/content_images/cs/mice-hand.gif"
         alt="micehandanim"/> <figcaption>
            <p><strong>Analyzing mice hand-movement using DeepLapCut</strong>
                    <a href="http://www.mousemotorlab.org/deeplabcut"><em>(Source: <a href="http://www.deeplabcut.org">www.deeplabcut.org</a> )</em></a></p>
        </figcaption>
</figure>

<blockquote cite="https://news.harvard.edu/gazette/story/newsplus/harvard-researchers-awarded-czi-open-source-award/">
    <p>Open Source Software is  accelerating Biomedicine. DeepLabCut enables automated video analysis of animal behavior using Deep Learning.</p>
    <footer align="right">—Alexander Mathis, <cite>Assistant Professor, École polytechnique fédérale de Lausanne <a href="https://www.epfl.ch/en/">(EPFL)</a></cite></footer>
</blockquote>
<h2 id="about-deeplabcut">About DeepLabCut</h2>
<p><a href="https://github.com/DeepLabCut/DeepLabCut">DeepLabCut</a> is an open source toolbox that empowers researchers at hundreds of institutions worldwide to track behaviour of laboratory animals, with very little training data, at human-level accuracy. With DeepLabCut  technology, scientists can delve deeper into the scientific understanding of motor control and behavior across animal species and timescales.</p>
<p>Several areas of research, including neuroscience, medicine, and biomechanics, use data from tracking animal movement. DeepLabCut helps in understanding what humans and other animals are doing by parsing actions that have been recorded on film. Using automation for laborious tasks of tagging and monitoring, along with deep neural network based data analysis, DeepLabCut makes scientific studies involving observing animals, such as primates, mice, fish, flies etc., much faster and more accurate.</p>
<figure class="fig-center">
    <img src="/images/content_images/cs/race-horse.gif"
         alt="horserideranim"/> <figcaption>
            <p><strong>Colored dots track the positions of a racehorse’s body part</strong><em>(Source: Mackenzie Mathis)</em></p>
        </figcaption>
</figure>

<p>DeepLabCut&rsquo;s non-invasive behavioral tracking of animals by extracting the poses of animals is crucial for scientific pursuits in domains such as biomechanics, genetics, ethology &amp; neuroscience. Measuring animal poses non-invasively from video - without markers - in dynamically changing backgrounds is computationally challenging, both technically as well as in terms of resource needs and training data required.</p>
<p>DeepLabCut allows researchers to estimate the pose of the subject, efficiently enabling them to quantify the behavior through a Python based software toolkit.  With DeepLabCut, researchers can identify distinct frames from videos, digitally label specific body parts in a few dozen frames with a tailored GUI, and then the deep learning based pose estimation architectures in DeepLabCut learn how to pick out those same features in the rest of the video and in other similar videos of animals. It works across species of animals, from common laboratory animals such as flies and mice to more unusual animals like <a href="https://www.technologynetworks.com/neuroscience/articles/interview-a-deeper-cut-into-behavior-with-mackenzie-mathis-327618">cheetahs</a>.</p>
<p>DeepLabCut uses a principle called <a href="https://arxiv.org/pdf/1909.11229">transfer learning</a>, which greatly reduces the amount of training data required and speeds up the convergence of the training period.  Depending on the needs, users can pick different network architectures that provide faster inference (e.g. MobileNetV2), which can also be combined with real-time experimental feedback. DeepLabCut originally used the feature detectors from a top-performing human pose estimation architecture, called <a href="https://arxiv.org/abs/1605.03170">DeeperCut</a>, which inspired the name. The package now has been significantly changed to include additional architectures, augmentation methods, and a full front-end user experience. Furthermore, to support large-scale biological experiments DeepLabCut provides active learning capabilities so that users can increase the training set over time to cover edge cases and make their pose estimation algorithm robust within the specific context.</p>
<p>Recently, the <a href="http://www.mousemotorlab.org/dlc-modelzoo">DeepLabCut model zoo</a> was introduced, which provides pre-trained models for various species and experimental conditions from facial analysis in primates to dog posture. This can be run for instance in the cloud without any labeling of new data, or neural network training, and no programming experience is necessary.</p>
<h3 id="key-goals-and-results">Key Goals and Results</h3>
<ul>
<li>
<p><strong>Automation of animal pose analysis for scientific studies:</strong></p>
<p>The primary objective of DeepLabCut technology is to measure and track posture
of animals in a diverse settings. This data can be used, for example, in
neuroscience studies to understand how the brain controls movement, or to
elucidate how animals socially interact. Researchers have observed a
<a href="https://www.biorxiv.org/content/10.1101/457242v1">tenfold performance boost</a>
with DeepLabCut. Poses can be inferred offline at up to 1200 frames per second
(FPS).</p>
</li>
<li>
<p><strong>Creation of an easy-to-use Python toolkit for pose estimation:</strong></p>
<p>DeepLabCut wanted to share their animal pose-estimation technology in the form
of an easy to use tool that can be adopted by researchers easily. So they have
created a complete, easy-to-use Python toolbox with project management features
as well. These enable not only automation of pose-estimation but also
managing the project end-to-end by helping the DeepLabCut Toolkit user right
from the dataset collection stage to creating shareable and reusable analysis
pipelines.</p>
<p>Their <a href="https://github.com/DeepLabCut/DeepLabCut">toolkit</a> is now available as open source.</p>
<p>A typical DeepLabCut Workflow includes:</p>
<ul>
<li>creation and refining of training sets via active learning</li>
<li>creation of tailored neural networks for specific animals and scenarios</li>
<li>code for large-scale inference on videos</li>
<li>draw inferences using integrated visualization tools</li>
</ul>
</li>
</ul>
<figure class="csfigcaption">
    <img src="/images/content_images/cs/deeplabcut-toolkit-steps.png"
         alt="dlcsteps"/> <figcaption>
            <p><strong>Pose estimation steps with DeepLabCut</strong>
                    <a href="https://twitter.com/DeepLabCut/status/1198046918284210176/photo/1">(Source: DeepLabCut)</a></p>
        </figcaption>
</figure>

<h3 id="the-challenges">The Challenges</h3>
<ul>
<li>
<p><strong>Speed</strong></p>
<p>Fast processing of animal behavior videos in order to measure their behavior
and at the same time make scientific experiments more efficient, accurate.
Extracting detailed animal poses for laboratory experiments, without
markers, in dynamically changing backgrounds, can be challenging, both
technically as well as in terms of resource needs and training data required.
Coming up with a tool that is easy to use without the need for skills such
as computer vision expertise that enables scientists to do research in more
real-world contexts, is a non-trivial problem to solve.</p>
</li>
<li>
<p><strong>Combinatorics</strong></p>
<p>Combinatorics involves assembly and integration of movement of multiple
limbs into individual animal behavior. Assembling keypoints and their
connections into individual animal movements and linking them across time
is a complex process that requires heavy-duty numerical analysis, especially
in case of multi-animal movement tracking in experiment videos.</p>
</li>
<li>
<p><strong>Data Processing</strong></p>
<p>Last but not the least, array manipulation - processing large stacks of
arrays corresponding to various images, target tensors and keypoints is
fairly challenging.</p>
</li>
</ul>
<figure class="csfigcaption">
    <img src="/images/content_images/cs/pose-estimation.png"
         alt="challengesfig"/> <figcaption>
            <p><strong>Pose estimation variety and complexity</strong>
                    <a href="https://www.biorxiv.org/content/10.1101/476531v1.full.pdf">(Source: Mackenzie Mathis)</a></p>
        </figcaption>
</figure>

<h2 id="numpys-role-in-meeting-pose-estimation-challenges">NumPy&rsquo;s Role in meeting Pose Estimation Challenges</h2>
<p>NumPy addresses DeepLabCut technology&rsquo;s core need of numerical computations at
high speed for behavioural analytics.  Besides NumPy, DeepLabCut employs
various Python software that utilize NumPy at their core, such as
<a href="https://www.scipy.org">SciPy</a>, <a href="https://pandas.pydata.org">Pandas</a>,
<a href="https://matplotlib.org">matplotlib</a>,
<a href="https://github.com/tensorpack/tensorpack">Tensorpack</a>,
<a href="https://github.com/aleju/imgaug">imgaug</a>,
<a href="https://scikit-learn.org/stable/">scikit-learn</a>,
<a href="https://scikit-image.org">scikit-image</a> and
<a href="https://www.tensorflow.org">Tensorflow</a>.</p>
<p>The following features of NumPy played a key role in addressing the image
processing, combinatorics requirements and need for fast computation in
DeepLabCut pose estimation algorithms:</p>
<ul>
<li>Vectorization</li>
<li>Masked Array Operations</li>
<li>Linear Algebra</li>
<li>Random Sampling</li>
<li>Reshaping of large arrays</li>
</ul>
<p>DeepLabCut utilizes NumPy’s array capabilities throughout the workflow offered
by the toolkit. In particular, NumPy is used for sampling distinct frames for
human annotation labeling, and for writing, editing and processing annotation
data.  Within TensorFlow the neural network is trained by DeepLabCut technology
over thousands of iterations to predict the ground truth annotations from
frames. For this purpose, target densities (scoremaps) are created to cast pose
estimation as a image-to-image translation problem. To make the neural networks
robust, data augmentation is employed, which requires the calculation of target
scoremaps subject to various geometric and image processing steps. To make
training fast, NumPy’s vectorization capabilities are leveraged. For inference,
the most likely predictions from target scoremaps need to extracted and one
needs to efficiently “link predictions to assemble individual animals”.</p>
<figure class="fig-center">
    <img src="/images/content_images/cs/deeplabcut-workflow.png"
         alt="workflow"/> <figcaption>
            <p><strong>DeepLabCut Workflow</strong>
                    <a href="https://www.researchgate.net/figure/DeepLabCut-work-flow-The-diagram-delineates-the-work-flow-as-well-as-the-directory-and_fig1_329185962"><em>(Source: Mackenzie Mathis)</em></a></p>
        </figcaption>
</figure>

<h2 id="summary">Summary</h2>
<p>Observing and efficiently describing behavior is a core tenant of modern
ethology, neuroscience, medicine, and technology.
<a href="http://orga.cvss.cc/wp-content/uploads/2019/05/NathMathis2019.pdf">DeepLabCut</a>
allows researchers to estimate the pose of the subject, efficiently enabling
them to quantify the behavior. With only a small set of training images,
the DeepLabCut Python toolbox allows training a neural network to within human
level labeling accuracy, thus expanding its application to not only behavior
analysis in the laboratory, but to potentially also in sports, gait analysis,
medicine and rehabilitation studies. Complex combinatorics, data processing
challenges faced by DeepLabCut algorithms are addressed through the use of
NumPy&rsquo;s array manipulation capabilities.</p>
<figure class="fig-center">
    <img src="/images/content_images/cs/numpy_dlc_benefits.png"
         alt="numpy benefits"/> <figcaption>
            <p><strong>Key NumPy Capabilities utilized</strong></p>
        </figcaption>
</figure>


    </div>
  </div>
</section>



  
  <div id="backtotop"><a href="#"></a></div>

  

  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://unpkg.com/feather-icons"></script>
<script src="/js/fresh.js"></script>
<script src="/js/jquery.panelslider.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/js/all.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"></script>

<script src="https://cdn.jsdelivr.net/npm/uikit@3.2.7/dist/js/uikit.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.2.7/dist/css/uikit.min.css" />

<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "joelachance/thebelab-requirements"
        },
    }
</script>
<script src="https://unpkg.com/thebelab@0.4.0/lib/index.js"></script>

<script src="/js/app.js"></script>


  
  
<footer id="footer" class="footer">
  <div class="container">
    <div id="footer-columns" class="columns">
      <div class="footer-logo-column">
        <img id="footer-logo" src="/images/logos/numpy.svg" alt="Numpy logo. A three-dimensional blue cube with the letter 'N' highlighted in yellow.">
      </div>
        <div class="link-column">
          <div class="footer-column">
            <div class="footer-header">
            </div>
            <ul class="link-list">
              <li class="link-list">
                <a class="footer-link" href="/install">
                  Install
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="https://numpy.org/doc/stable">
                  Documentation
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="/learn">
                  Learn
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="https://numpy.org/neps/roadmap.html">
                  Roadmap
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="link-column">
          <div class="footer-column">
            <div class="footer-header">
            </div>
            <ul class="link-list">
              <li class="link-list">
                <a class="footer-link" href="/about">
                  About us
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="/community">
                  Community
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="/contribute">
                  Contribute
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="/code-of-conduct">
                  Code of conduct
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="link-column">
          <div class="footer-column">
            <div class="footer-header">
            </div>
            <ul class="link-list">
              <li class="link-list">
                <a class="footer-link" href="/gethelp">
                  Get help
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="/terms">
                  Terms of use
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="/privacy">
                  Privacy
                </a>
              </li>
              <li class="link-list">
                <a class="footer-link" href="/press-kit">
                  Press kit
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="footer-actions">
            <p>Sign up for the latest NumPy news, resources, <br> and more</p>
            
            <form action="https://numpy.us4.list-manage.com/subscribe/post?u=5ddd0d1d6e807900a8212481a&amp;id=287fa4253c" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate sign-up-container" target="_blank" novalidate>
                <div class="sign-up-image">
                    <i class="far fa-envelope"></i>
                </div>
                <input type="email" value="" name="EMAIL" class="required email sign-up-input" id="mce-EMAIL" aria-label="Input for email, press enter to submit" onkeypress="if (event.which === 13 || event.keyCode === 13 || event.key === 'Enter') sendThankYou()" />
                <div class="submission-instructions">Press Enter</div>
                <button class="signup-button" onclick="sendThankYou()" aria-label="Submit">
                    <i class="far fa-paper-plane"></i>
                </button>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>
                
                <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_5ddd0d1d6e807900a8212481a_287fa4253c" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" style="display: none;"></div>
            </form>
            <div class="thank-you">Thank you! &#127881;</div>
            

            <nav class="level is-mobile">
                <div class="social-media-icons">
                    <a class="level-item" href="https://github.com/numpy/numpy" aria-label="https://github.com/numpy/numpy">
                    <span class="icon"><i class="fab fa-github"></i></span>
                    </a>
                    <a class="level-item" href="https://twitter.com/numpy_team" aria-label="https://twitter.com/numpy_team">
                    <span class="icon"><i class="fab fa-twitter"></i></span>
                    </a>
                </div>
            </nav>
            <div class="copyright">&copy; 2019-2020 NumPy. All rights reserved.</div>
        </div>
    </div>
  </div>
</footer>

  
</body>

</html>